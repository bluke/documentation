<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
    <meta content='width=device-width, initial-scale=1' name='viewport'>
    <link href="/assets/stylesheets/documentation.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/assets/javascripts/documentation.js" type="text/javascript"></script>
  </head>
  <body class='guides guides_vpn guides_vpn_index'>
    <header class='notice'>
      <p>En cas de problème avec la documentation, veuillez <a href="https://github.com/ares-ensiie/documentation/issues/new">ouvrir une issue</a> ou nous contacter sur <a href="irc://irc.iiens.net/%23ares">#ares</a></p>
    </header>
    <article>
      <h1>Connexion au VPN</h1>&#x000A;&#x000A;<p>Vous en avez marre du firewall de l&#39;ISU et de son proxy infernal ! Oui à ARES aussi on en a GROS ! C&#39;est pour ça que nous vous proposons de passer par nos machines pour sortir sur le vaste Internet.&#x000A;Qu&#39;est-ce qu&#39;un VPN (Virtual Private Network)</p>&#x000A;&#x000A;<p>En deux mots quand vous êtes à l&#39;ISU et que vous vous connectez au wifi ENSIIE:</p>&#x000A;&#x000A;<h2>Sans VPN</h2>&#x000A;&#x000A;<p>Votre requête sur <code>http://google.com</code> passe doit passer par le proxy de l&#39;ISU (où elle est analysée btw) avant de sortir dans le vaste espace.&#x000A;    Lorsque vous essayez de vous connecter à notre serveur Minecraft, la connexion échoue lamentablement car l&#39;ISU a eu la bonne idée de bloquer l&#39;intégralité des ports sauf quelques uns.</p>&#x000A;&#x000A;<h2>Avec VPN</h2>&#x000A;&#x000A;<p>Un lien chiffré illisible par l&#39;ISU relie votre ordinateur à nos serveurs, vous êtes virtuellement branchés sur le même switch que notre infrastructure.&#x000A;    La conséquence direct c&#39;est que nous ne filtrons rien, donc il n&#39;y a plus de proxy et tous les ports sont accessibles.</p>&#x000A;&#x000A;<p>→ Plus de proxy, et tous les protocoles accessibles.</p>&#x000A;&#x000A;<h2>Responsabilité</h2>&#x000A;&#x000A;<p>Vous ne passez plus par l&#39;infrastructure de l&#39;ISU, mais vous passez par les machines de l&#39;association. Nous vous identifions et nous avons l&#39;obligation légal d&#39;enregistrer vos connexion pendant la durée d&#39;un an. Donc notre VPN est loin d&#39;être anonyme. Si vous cherchez quelque chose comme ça, 5€/mois c&#39;est pas de trop ;-) Nous nous basons sur un principe de fair use, comprendre que si une personne mange en permanence notre bande passante nous prendrons les mesures nécessaires. De la même manière nous sanctionnerons dans le cas d&#39;un usage illégal de notre connexion.</p>&#x000A;&#x000A;<h2>Comment se connecter ?</h2>&#x000A;&#x000A;<p>Pour ajouter l&#39;intégration de network manager à Network Manager, votre gestionnaire de connexions : </p>&#x000A;<div class="highlight"><pre><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">network</span><span class="o">-</span><span class="n">manager</span><span class="o">-</span><span class="n">openvpn</span>&#x000A;</pre></div>&#x000A;<p>Tout d&#39;abord, quelque soit la technique, il est nécessaire de récupérer quelques fichiers.</p>&#x000A;&#x000A;<p><code>https://vpn.ares-ensiie.eu</code> :&#x000A;<div style="text-align:center">&#x000A;    <img src="./vpn/vpn.ares-ensiie.eu.png" width="60%"/>&#x000A;</div></p>&#x000A;&#x000A;<h3>Sous Linux</h3>&#x000A;&#x000A;<h4>Graphiquement (GNOME/Unity)</h4>&#x000A;&#x000A;<h5>Ajout d&#39;un VPN :</h5>&#x000A;&#x000A;<div style="text-align:center">&#x000A;    <img src="./vpn/ubuntu_1.png" width="60%" >&#x000A;    <img src="./vpn/ubuntu_2.png" width="60%" style="text-align-center"/>&#x000A;</div>&#x000A;&#x000A;<h5>Type de VPN :</h5>&#x000A;&#x000A;<div style="text-align:center">&#x000A;    <img src="./vpn/ubuntu_3.png" width="60%" style="text-align-center"/>&#x000A;</div>&#x000A;&#x000A;<h5>Configuration :</h5>&#x000A;&#x000A;<div style="text-align:center">&#x000A;    <img src="./vpn/ubuntu_4.png" width="60%" style="text-align-center"/>&#x000A;    <img src="./vpn/ubuntu_5.png" width="60%" style="text-align-center"/>&#x000A;    <img src="./vpn/ubuntu_6.png" width="60%" style="text-align-center"/>&#x000A;</div>&#x000A;&#x000A;<h5>Connexion :</h5>&#x000A;&#x000A;<div style="text-align:center">&#x000A;    <img src="./vpn/ubuntu_7.png" width="60%"/>&#x000A;    <img src="./vpn/ubuntu_8.png" width="60%"/>&#x000A;</div>&#x000A;&#x000A;<h4>En ligne de commande (Universel)</h4>&#x000A;&#x000A;<p>Télécharger le fichier ce configuration suivant : <code>conf.zip</code> et décompressez le. Changer ensuite l&#39;emplacement ca, cert et key puis faites :</p>&#x000A;<div class="highlight"><pre><span class="n">openvpn</span> <span class="err">–</span><span class="n">config</span> <span class="o">/</span><span class="n">chemin</span><span class="o">/</span><span class="n">vers</span><span class="o">/</span><span class="n">client</span><span class="p">.</span><span class="n">conf</span>&#x000A;</pre></div>&#x000A;<p>Remplacez le contenu de <code>/etc/resolv.conf</code> par</p>&#x000A;<div class="highlight"><pre><span class="n">domain</span> <span class="n">ares</span>&#x000A;<span class="n">nameserver</span> <span class="mf">10.0.2.1</span>&#x000A;<span class="n">nameserver</span> <span class="mf">8.8.8.8</span>&#x000A;</pre></div>&#x000A;<p>Il se peut qu&#39;en vous connectant en ligne de commande vous ayez des problèmes de routage, il faut préciser la règle suivant</p>&#x000A;<div class="highlight"><pre><span class="n">route</span> <span class="n">add</span> <span class="mf">130.79.243.34</span><span class="o">/</span><span class="mi">32</span> <span class="p">[</span><span class="n">VotrePasserelleParD</span><span class="err">é</span><span class="n">faut</span><span class="p">]</span>&#x000A;</pre></div>&#x000A;<h3>Sous Windows</h3>&#x000A;&#x000A;<p>Tout d&#39;abord il vous faut installer OpenVPN pour Windows</p>&#x000A;&#x000A;<p>Récupérez ensuite le fichier de configuration d&#39;OpenVPN : <code>conf.zip</code></p>&#x000A;&#x000A;<p>Décompressez puis placez le ainsi que les certificats et la clef dans le dossier suivant :</p>&#x000A;<div class="highlight"><pre><span class="nl">C:</span><span class="err">\</span><span class="n">Program</span> <span class="n">Files</span> <span class="p">(</span><span class="n">x86</span><span class="p">)</span><span class="err">\</span><span class="n">OpenVPN</span><span class="err">\</span><span class="n">config</span> <span class="p">(</span><span class="n">Pour</span> <span class="n">Windows</span> <span class="mi">64</span><span class="n">bits</span><span class="p">)</span>&#x000A;<span class="nl">C:</span><span class="err">\</span><span class="n">Program</span> <span class="n">Files</span><span class="err">\</span><span class="n">OpenVPN</span><span class="err">\</span><span class="n">config</span> <span class="p">(</span><span class="n">Pour</span> <span class="n">Windows</span> <span class="mi">32</span><span class="n">bits</span><span class="p">)</span>&#x000A;</pre></div>&#x000A;<p>Editez le fichier de configuration et modifiez les champs ca, cert et key.</p>&#x000A;&#x000A;<p><code>client.conf</code>:</p>&#x000A;<div class="highlight"><pre><span class="n">ca</span> <span class="n">ca</span><span class="p">.</span><span class="n">crt</span>&#x000A;<span class="n">cert</span> <span class="err">$</span><span class="n">USER</span><span class="err">$</span><span class="p">.</span><span class="n">crt</span>&#x000A;<span class="n">key</span> <span class="err">$</span><span class="n">USER</span><span class="err">$</span><span class="p">.</span><span class="n">key</span>&#x000A;</pre></div>&#x000A;<p>Renommez le en <code>client.ovpn</code>.</p>&#x000A;&#x000A;<p>Lancez l&#39;application OpenVPN GUI qui va automatiquement détecter le fichier de configuration et vous demander vos identifiants.</p>&#x000A;&#x000A;<p>Cependant ce n&#39;est pas forcément suffisant, car Windows c&#39;est tout pourri =D</p>&#x000A;&#x000A;<p>Lancez un terminal en tant qu&#39;administrateur:&#x000A;<div style="text-align:center">&#x000A;    <img src="./vpn/windows_1.png" width="60%"/>&#x000A;</div>&#x000A;Lancez la commande:</p>&#x000A;<div class="highlight"><pre><span class="n">route</span> <span class="n">print</span> &#x000A;</pre></div>&#x000A;<p>vous pourrez observer ça :&#x000A;<div style="text-align:center">&#x000A;    <img src="./vpn/windows_2.png" width="60%"/>&#x000A;</div>&#x000A;Repérez l&#39;identifiant de votre interface, pour ma part:</p>&#x000A;<div class="highlight"><pre> <span class="n">Dell</span> <span class="n">Wireless</span> <span class="err">→</span> <span class="mi">12</span>&#x000A;</pre></div>&#x000A;<p>Et lancez la commande:</p>&#x000A;<div class="highlight"><pre><span class="n">route</span> <span class="n">add</span> <span class="mf">130.79.243.34</span> <span class="err">$</span><span class="n">IPGATEWAY</span> <span class="k">if</span> <span class="err">$</span><span class="n">IFID</span>&#x000A;</pre></div>&#x000A;<p>A l&#39;ISU réseau “ENSIIE”:</p>&#x000A;<div class="highlight"><pre><span class="n">IPGATEWAY</span> <span class="o">:</span> <span class="mf">172.16</span><span class="o">.</span><span class="mf">41.254</span>&#x000A;</pre></div>&#x000A;<p>route</p>&#x000A;<div class="highlight"><pre><span class="n">route</span> <span class="n">add</span> <span class="mf">130.79.243.34</span> <span class="mf">172.16.41.254</span> <span class="k">if</span> <span class="mi">12</span>&#x000A;</pre></div>&#x000A;<h3>Sous Mac OS X</h3>&#x000A;&#x000A;<p>Après avoir installé <code>openvpn</code>, utiliser la technique en ligne de commande Linux.</p>
    </article>
  </body>
</html>
